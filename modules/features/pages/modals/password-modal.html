<!doctype html>
<html>
<head>
<meta charset="utf-8">
</head>
<body>
  <template id="tpl-password-modal">
    <style>
      /* 作用域：仅限 .password-modal-root */
      .password-modal-root .form-item { margin-bottom: 14px; }
      .password-modal-root .form-label { display:block; font-size:13px; margin-bottom:4px; color:#cfd6dd; }
      .password-modal-root .form-field input { width:100%; box-sizing:border-box; padding:6px 10px; background:#161b21; border:1px solid #2c343c; border-radius:4px; color:#fff; font-size:13px; outline:none; transition:border-color .15s; }
      .password-modal-root .form-field input:focus { border-color:#3d78d4; }
      .password-modal-root .form-field .readonly { opacity:.8; }
      .password-modal-root .pwd-field { position:relative; display:flex; align-items:center; gap:4px; }
      .password-modal-root .pwd-field input { padding-right:40px; }
      .password-modal-root .pwd-eye { position:absolute; right:6px; top:50%; transform:translateY(-50%); background:transparent; border:none; cursor:pointer; color:#9aa5b1; font-size:16px; line-height:1; padding:0 4px; }
      .password-modal-root .pwd-eye:hover { color:#fff; }
      .password-modal-root .pwd-mini-actions { display:flex; gap:6px; margin-top:6px; }
      .password-modal-root .btn.btn-xs { padding:2px 8px; font-size:12px; line-height:18px; background:#1f2730; border:1px solid #2f3944; color:#cfd6dd; cursor:pointer; border-radius:4px; }
      .password-modal-root .btn.btn-xs:hover { background:#2a3440; }
      .password-modal-root .pwd-strength-wrap { margin-top:6px; display:flex; align-items:center; gap:8px; }
      .password-modal-root .pwd-strength-bg { flex:1; height:6px; border-radius:3px; background:#232b33; overflow:hidden; }
      .password-modal-root .pwd-strength-bar { height:100%; width:0; background:linear-gradient(90deg,#e74c3c,#f39c12,#2ecc71); transition:width .25s; filter:brightness(.85); }
      .password-modal-root .pwd-strength-bar[data-level="弱"] { background:#e74c3c; }
      .password-modal-root .pwd-strength-bar[data-level="中"] { background:linear-gradient(90deg,#f39c12,#f1c40f); }
      .password-modal-root .pwd-strength-bar[data-level="强"] { background:#2ecc71; }
      .password-modal-root .pwd-strength-label { min-width:32px; font-size:12px; color:#9aa5b1; }
      .password-modal-root .pwd-inline-msg { font-size:12px; margin-top:4px; min-height:18px; }
      .password-modal-root .pwd-inline-msg.err { color:#e57373; }
      .password-modal-root .pwd-inline-msg.ok { color:#55d899; }
      .password-modal-root .pwd-rules { margin:6px 0 0; padding-left:16px; list-style:disc; font-size:12px; color:#6c7883; line-height:1.5; }
      .password-modal-root .form-actions { display:flex; gap:12px; margin-top:4px; }
      .password-modal-root #btnPwdSubmit:disabled { opacity:.5; cursor:not-allowed; }
      .password-modal-root .req { color:#ed6a5e; }
    </style>

    <div class="password-modal-root">
      <form id="pwdForm" autocomplete="off">
        <div class="form-item">
          <label class="form-label">用户</label>
          <div class="form-field">
            <input class="readonly" id="pwdUserInfo" disabled />
          </div>
        </div>

        <div class="form-item" id="oldPwdBlock" style="display:none;">
          <label class="form-label">旧密码 <span class="req">*</span></label>
          <div class="form-field pwd-field">
            <input type="password" name="oldpwd" placeholder="输入当前密码" minlength="1" autocomplete="current-password" />
            <button type="button" class="pwd-eye" title="显示/隐藏">👁</button>
          </div>
        </div>

        <div class="form-item">
          <label class="form-label">新密码 <span class="req">*</span></label>
          <div class="form-field">
            <div class="pwd-field">
              <input type="password" name="pwd1" placeholder="至少8位，含2种类别" minlength="8" autocomplete="new-password" required />
              <button type="button" class="pwd-eye" title="显示/隐藏">👁</button>
            </div>
            <div class="pwd-mini-actions">
              <button type="button" class="btn btn-xs" id="btnGenPwd" title="生成随机强密码">生成</button>
              <button type="button" class="btn btn-xs" id="btnCopyPwd" title="复制当前密码">复制</button>
            </div>
          </div>
          <div class="pwd-strength-wrap">
            <div class="pwd-strength-bg">
              <div id="pwdStrengthBar" class="pwd-strength-bar" data-level=""></div>
            </div>
            <span id="pwdStrengthLabel" class="pwd-strength-label"></span>
          </div>
        </div>

        <div class="form-item">
          <label class="form-label">确认密码 <span class="req">*</span></label>
          <div class="form-field">
            <div class="pwd-field">
              <input type="password" name="pwd2" placeholder="再次输入新密码" minlength="8" autocomplete="new-password" required />
              <button type="button" class="pwd-eye" title="显示/隐藏">👁</button>
            </div>
          </div>
        </div>

        <div class="form-item">
          <div id="pwdInlineMsg" class="pwd-inline-msg"></div>
          <ul class="pwd-rules" id="pwdRulesList">
            <!-- 本人修改时，JS 会追加“本人修改需输入旧密码” -->
            <li>长度 ≥ 8</li>
            <li>至少 2 类字符（大写/小写/数字/符号）</li>
            <li>两次新密码一致</li>
          </ul>
        </div>

        <div class="form-actions">
          <button type="submit" id="btnPwdSubmit" class="btn btn-primary" disabled>确认</button>
          <button type="button" class="btn" data-close>取消</button>
        </div>
      </form>
    </div>
  </template>
</body>
</html>